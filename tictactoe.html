<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
    function to_page(from, to) {
        $(from).css('display', 'none')
        $(to).css('display', 'block')
    }
    function ai_move(letter) {
        possible_move = []
        for (var i = 1; i < 10; i++) {
            if ($('#' + i).html() == '&nbsp;') {
                possible_move.push('#' + i)
            }
        }
        console.log('possible_move: ', possible_move)
        block_move = []
        win_move = ''
        random_move = Math.floor(Math.random() * possible_move.length)
        for (var i in possible_move) {
            var store = $(possible_move[i]).text()
            $(possible_move[i]).text(player0_letter)
            if (check_win(player0_letter)) {
                block_move.push(possible_move[i])
            }
            $(possible_move[i]).text(store)
        }
        for (var i in possible_move) {
            $(possible_move[i]).text(player1_letter)
            if (check_win(player1_letter)) {
                win_move = possible_move[i]
            }
            $(possible_move[i]).html('&nbsp;')
        }
        if (win_move) {
            $(win_move).text(letter)
        }
        else if (block_move.toString() !== [].toString()) {
            console.log('block_move: ', block_move)
            $(block_move[0]).text(letter)
        }
        else {
            $(possible_move[random_move]).text(letter)
        }


    }
    function reset_board() {
        for (var i = 1; i < 10; i++) {
            if ($('#' + i).html() !== '&nbsp;') {
                $('#' + i).html('&nbsp;')
            }
        }
        $('.cell').css('background-color', 'whitesmoke')
        $('.cell').prop('disabled', false)
    }
    function check_win(letter) {
        if (($('#1').text() == letter && $('#2').text() == letter && $('#3').text() == letter) ||
            ($('#4').text() == letter && $('#5').text() == letter && $('#6').text() == letter) ||
            ($('#7').text() == letter && $('#8').text() == letter && $('#9').text() == letter) ||
            ($('#1').text() == letter && $('#5').text() == letter && $('#9').text() == letter) ||
            ($('#3').text() == letter && $('#5').text() == letter && $('#7').text() == letter) ||
            ($('#1').text() == letter && $('#4').text() == letter && $('#7').text() == letter) ||
            ($('#2').text() == letter && $('#5').text() == letter && $('#8').text() == letter) ||
            ($('#3').text() == letter && $('#6').text() == letter && $('#9').text() == letter)) { return true }

    }
    function check_tie() {
        var count = 0
        for (var i = 1; i < 10; i++) {
            if ($('#' + i).html() !== '&nbsp;') {
                count += 1
            }
        } if (count == 9) {
            $('#stat').text('TIE')
            $('.cell').css('background-color', '#aaa')
            $('#fuck').slideDown(1000)
            $('.cell').prop('disabled', true)
        }
    }
    function random_choice() {
        var rand = Math.floor(Math.random() * 2)
        return rand
    }
    function change_turn(player_list) {
        if (turn == player_list[0]) {
            turn = player_list[1]
            $('#turn1').css('display', 'none')
            $('#turn2').css('display', 'block')
            $('#turn2').text(player_list[1])
        }
        else {
            turn = player_list[0]
            $('#turn1').css('display', 'block')
            $('#turn1').text(player_list[0])
            $('#turn2').css('display', 'none')
        }
    }
    $(document).ready(function () {
        fucking = false
        $('.choose').click(function () {
            to_page('#first', '#second')
            if ($(this).text() == 'One player') {
                player_list = ['Player', 'Computer']
                two_player = false
            }
            else {
                player_list = ['Player 1', 'Player 2']
                two_player = true
            }
            //console.log(player_list)
            //console.log('two_player:', two_player)
        })

        $('#back').click(function () {
            to_page('#second', '#first')
        })

        $('.letter').click(function () {
            if ($(this).text() == 'X') {
                player0_letter = 'X'
                player1_letter = 'O'
            } else {
                player0_letter = 'O'
                player1_letter = 'X'
            }
            to_page('#second', '#third')
            turn = player_list[random_choice()]
            change_turn(player_list)
            //game starts from here
            if (turn == 'Computer') {
                setTimeout(function () {
                    ai_move(player1_letter)
                    change_turn(player_list)
                }, 1000)

            }
            //console.log('turn: ', turn)
            if (!two_player) {
                console.log('2player: ', two_player)
                $('.cell').click(function () {
                    if ($(this).html() == '&nbsp;' && turn == 'Player') {

                        $(this).text(player0_letter)
                        if (check_win(player0_letter)) {
                            $('#stat').text('PLayer WIN')
                            $('.cell').css('background-color', '#aaa')
                            $('#fuck').slideDown(1000)
                            $('.cell').prop('disabled', true)
                        }
                        else {
                            check_tie()
                            change_turn(player_list)
                            console.log(turn)
                        }
                        if (turn == 'Computer') {
                            console.log('comp turn')
                            setTimeout(function () {
                                ai_move(player1_letter)
                                if (check_win(player1_letter)) {
                                    $('#stat').text('Computer WIN')
                                    $('.cell').css('background-color', '#aaa')
                                    $('#fuck').slideDown(1000)
                                    $('.cell').prop('disabled', true)
                                }
                                else {
                                    change_turn(player_list)
                                    check_tie()
                                }
                            }, 500)
                        }
                    }
                })
            }
            else {
                console.log('two_player: ', two_player)
                $('.cell').click(function () {

                    if ($(this).html() == '&nbsp;' && turn == 'Player 1') {
                        $(this).text(player0_letter)
                        if (check_win(player0_letter)) {
                            $('#stat').text('Player 1 WIN')
                            $('.cell').css('background-color', '#aaa')
                            $('#fuck').slideDown(1000)
                            $('.cell').prop('disabled', true)
                        } else {
                            check_tie()
                            change_turn(player_list)
                            console.log(turn)
                        }
                    } else if ($(this).html() == '&nbsp;' && turn == 'Player 2') {
                        $(this).text(player1_letter)
                        if (check_win(player1_letter)) {
                            $('#stat').text('Player 2 WIN')
                            $('.cell').css('background-color', '#aaa')
                            $('#fuck').slideDown(1000)
                            $('.cell').prop('disabled', true)
                        } else {
                            check_tie()
                            change_turn(player_list)
                        }
                    }
                })
            }

        })

        $('#again').click(function () {
            $('#turn1').css('display', 'none')
            $('#turn2').css('display', 'none')
            to_page('#third', '#first')
            $('#fuck').css('display', 'none')
            reset_board()
            $('#stat').text('Game board')

        })
    })

</script>





<style>
    body {
        background-color: #444;
    }

    div {
        background-color: #777;
        width: 400px;
        height: 400px;
        color: white;
        margin-left: auto;
        margin-right: auto;
        margin-bottom: 0;
        text-align: center;
    }

    .button-noborder {
        border: none;
        font-size: 30px;
        background-color: #777;
        margin: 10px;
    }

    .button-noborder:hover {
        border: 2px dashed whitesmoke;
    }

    .border {
        border: 2px solid white;
    }

    .cell {
        height: 30%;
        width: 32%;
        background-color: whitesmoke;
        color: black;
        font-size: 50px;
        font-family: monospace;
    }
</style>



<div id='infor' style="margin-top: 0; height: 50px; background-color: #444">
    <p id='turn1' style="float: left; display: none; margin-top: 25px;">Player turn</p>
    <p id='turn2' style="float: right; display: none; margin-top: 25px">Computer turn</p>
</div>

<div id='first'>
    <h1>How do u want to play?</h1>
    <button class="button-noborder choose">One player</button>
    <button class="button-noborder choose">Two player</button>
</div>

<div id='second' style="display: none">
    <h1>What do u perfer</h1>
    <button class="button-noborder letter">X</button>
    <button class="button-noborder letter">O</button>
    <br>
    <button id='back' class="button-noborder">Back</button>
</div>

<div id="third" style="display: none">
    <p id='stat'>Game board</p>
    <button id='1' class='cell'>&nbsp;</button>
    <button id='2' class='cell'>&nbsp;</button>
    <button id='3' class='cell'>&nbsp;</button>

    <button id='4' class='cell'>&nbsp;</button>
    <button id='5' class='cell'>&nbsp;</button>
    <button id='6' class='cell'>&nbsp;</button>

    <button id='7' class='cell'>&nbsp;</button>
    <button id='8' class='cell'>&nbsp;</button>
    <button id='9' class='cell'>&nbsp;</button>
</div>
<div id='fuck' style="display: none; height: 80px; margin-top: 0;">
    <h3 style="margin-top: 0">wanna play again?</h3>
    <button id='again'>yes</button>
</div>
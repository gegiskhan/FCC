<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
    x = []
    flag = 'replace'
    oper_flag = 1
    
    function press(num) {
        if (flag == 'replace') {//replace display
            $('#display').text(num)
        }
        else {// or append display
            if ($('#display').text().length<14){
                $('#display').append(num)
            }
        }
        flag = 'append'
        oper_flag = 1
    }

    function action(operator) {
        if (oper_flag == 1) {
            flag = 'replace'
            x.push($('#display').text())
            x.push(operator)
            $('#show').text(x.join(' ').replace(/\*/g, 'x').slice(-30))
            //console.log('X: ', x)
            temp = x.slice()
            temp.pop()
            //console.log('temp: ', temp)
            var a =eval(temp.join(''))
            var b = a.toString()
            if (b.length > 14 ) {
                $('#display').text(a.toPrecision(9))
            }
            else{
                $('#display').text(a)
            }
            oper_flag = 0
        }
    }

    $(document).ready(function () {
        //console.log(Number.isFinite(1/3))
        $('#clear').click(function () {
            $('#show').html('&nbsp;')
            $('#display').text(0)
            x = []
            flag = 'replace'
        })
        $('#clear_display').click(function () {
            $('#display').text(0)
            flag = 'replace'
            
        })
        $('#num1').click(function () {
            press(1)
        })
        $('#num2').click(function () {
            press(2)
        })
        $('#num3').click(function () {
            press(3)
        })
        $('#num4').click(function () {
            press(4)
        })
        $('#num5').click(function () {
            press(5)
        })
        $('#num6').click(function () {
            press(6)
        })
        $('#num7').click(function () {
            press(7)
        })
        $('#num8').click(function () {
            press(8)
        })
        $('#num9').click(function () {
            press(9)
        })
        $('#num0').click(function () {
            press(0)
        })
        $('#numdot').click(function () {
            press('.')
        })
        
        $('#plus').click(function () {
            action('+')
        })
        $('#sub').click(function () {
            action('-')
        })
        $('#mul').click(function () {
            action('*')
        })
        $('#div').click(function () {
            action('/')
        })
        $('#num-neg').click(function () {
            var a =$('#display').text()
            $('#display').text(-a)
        })
        $('#re').click(function () {
            var a =$('#display').text()
            if (a.length==1){
                $('#display').text(0)
                flag='replace'
            }
            else{
                $('#display').text(a.slice(0, -1))
                flag='append'
            }
        })

        $('#result').click(function () {
            x.push($('#display').text())
            var a = eval(x.join(''))
            console.log(a)
            var b= a.toString()
            console.log(b)
            
            if (b.length > 14 ) {
                $('#display').text(a.toPrecision(9))
                console.log(a.toPrecision(10))
            }
            else{
                $('#display').text(a)
            }
            $('#show').text(x.join(' ').replace(/\*/g, 'x') + ' = ' )
            x = []
            flag = 'replace'
            oper_flag = 1
        })
    })

</script>

<style>
    body {
        background-color: #777;
    }
    .larger {
        font-size: 20px;
    }
    .dark {
        background-color: #777;
    }
    .light{
        background-color: #eee;
        
    }
    .container {
        width: 300px;
        margin-top: 50px;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 10px 10px 40px 0px;
        border-bottom: 5px ridge #222;
    }
    button {
        background-color: #777;
        height: 45px;
        width: 60px;
        text-align: center;
        color: whitesmoke;
        border-radius: 10px;
        
    }
    button:hover{
        background-color: #999;
        
    }
    .indent{
        margin: 10px;
    }
    .display{
        margin-bottom: 30px;
        text-align: right;
        background-color: #ccc;
        border-radius: 5px;
        border-top: 4px solid #999;
        border-left: 4px solid #999;
        border-bottom: 4px solid #fff;
        border-right: 4px solid #fff;
    }
    @media screen and (max-width: 500px){
        .container{
            transform: scale(0.8)
        }
    }
</style>
<div class="container text-center light">
    <p style="text-align: left; margin-bottom: 30px; font-family: monospace">Gegiskhan's Calculator</p>
    <div class='display'>
        <p id='show' class="indent" style="margin-top: 0px">&nbsp;</p>
        <p id='display' style="font-size: 30px; margin-bottom: 0px;" class="indent">0</p>
    </div>
    <button class="larger" id="clear_display" style="background-color: #D14841">CE</button>
    <button class="larger" id="clear" style="background-color: #D14841">C</button>
    <button class="larger" id="re">re</button>
    <button id='div' class='larger'>&divide;</button>

    <button class="larger" id='num7'>7</button>
    <button class="larger" id='num8'>8</button>
    <button class="larger" id='num9'>9</button>
    <button id='mul' class='larger'>x</button>

    <button class="larger" id='num4'>4</button>
    <button class="larger" id='num5'>5</button>
    <button class="larger" id='num6'>6</button>
    <button id='sub' class='larger'>-</button>
    
    <button class="larger" id='num1'>1</button>
    <button class="larger" id='num2'>2</button>
    <button class="larger" id='num3'>3</button>
    <button id='plus' class='larger'>+</button>
    
    <button class="larger" id='num-neg'>&plusmn;</button>
    <button class="larger" id='num0'>0</button>
    <button class="larger" id='numdot'>.</button>
    <button class="larger" id="result">=</button>
</div>